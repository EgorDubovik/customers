!function(e){e.fn.timerD=function(t){var n={amPM:!0,setTime:moment(),onChange:null,typeView:"daysName",returnFormat:"YYYY-MM-DD HH:mm"},a=e.extend({},n,t);a.setTime=moment(a.setTime);var i=e(this),d=null,s=null,o=!1,r=!1,m=!1,u=!0;let l=null,c=null,f=null,p=null,h=null,y=null;this.init=function(){return _(),T(),$(),g(),v(),this};var $=function(){"daysName"==a.typeView?(o=!1,r=!1,m=!1,u=!0):(o=!0,r=!0,m=!0,u=!1)},_=function(){s=(d=a.setTime).clone()},T=function(){let e=15*Math.round(s.minute()/15);s.minute(e),s.second(0)},g=function(){if(i.empty(),u){let t=e("<div>").addClass("day-name").addClass("conteiner");i.append(t),l=new C(t,{dataType:"daysName",setTime:s,onDataChange:function(e,t){s.month(t.month()),s.date(t.date()),s.year(t.year()),v()}})}if(o){let n=e("<div>").addClass("month").addClass("conteiner");i.append(n),c=new C(n,{dataType:"months",setTime:s,onDataChange:function(e){s.month(e),f.refreshData(s),v()}})}if(r){let d=e("<div>").addClass("days").addClass("conteiner");i.append(d),f=new C(d,{dataType:"days",setTime:s,onDataChange:function(e){s.date(e),v()}})}if(m){let $=e("<div>").addClass("years").addClass("conteiner");i.append($),p=new C($,{dataType:"years",setTime:s,onDataChange:function(e){s.year(e),v()}})}{let _=e("<div>").addClass("hour").addClass("conteiner");i.append(_),drumyHours=new C(_,{dataType:"hours",setTime:s,onDataChange:function(e){a.amPM&&(e=12==(e="PM"==s.format("A")&&12!=e?e+12:e)&&"AM"==s.format("A")?0:e),s.hour(e),v()}})}{let T=e("<div>").addClass("minute").addClass("conteiner");i.append(T),h=new C(T,{dataType:"minutes",setTime:s,onDataChange:function(e){s.minute(e),v()}})}if(a.amPM){let g=e("<div>").addClass("ampm").addClass("conteiner");i.append(g),y=new C(g,{dataType:"ampm",isLoop:!1,setTime:s,onDataChange:function(e){s.format("A")!=e&&("AM"==e?s.add(-12,"hours"):s.add(12,"hours")),v()}})}},v=function(){a.onChange&&(console.log(s,s.format(a.returnFormat)),a.onChange(s.format(a.returnFormat)))},C=function(t,n){var a={isLoop:!0,itemHeight:40,dataType:null,dataIndex:0,data:[],setTime:moment(),amPM:!0,onDataChange:null},n=e.extend({},a,n),i=n.data,d=0,t=t,s=this;let o=0,r=n.setTime.clone();this.hummer=null;var m=e("<div>").addClass("drum-items").css("margin-top","0px").css("transform","translate3d(0px, 0px, 0px)"),u=e("<div>").addClass("drum-inner"),l=e("<div>").addClass("drum-wrapper"),c=function(){"months"==n.dataType?i=h(n.setTime.month()):"days"==n.dataType?i=y():"years"==n.dataType?i=$():"daysName"==n.dataType?i=p(r):"hours"==n.dataType?i=_():"minutes"==n.dataType?i=T():"ampm"==n.dataType&&(i=["AM","PM"])},f=function(e){if("months"==n.dataType){let t=i[d+e];r.month(t),i=h()}else if("days"==n.dataType){let a=i[d+e];r.date(a),i=y()}else if("years"==n.dataType)r.add(e,"year"),i=$();else if("hours"==n.dataType){let s=i[d+e];r.hour(s),i=_()}else if("minutes"==n.dataType){let o=i[d+e];r.minute(o),i=T()}else"daysName"==n.dataType&&(r.add(e,"days"),i=p(r))},p=function(e){let t=e.clone().add(-10,"days"),n=[],a=moment();for(let i=0;i<30;i++)t.isSame(a,"date")?n.push("Today"):n.push(t.format("ddd MMM DD")),t.add(1,"days");return n},h=function(){let e=r.month(),t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=t.slice(e).concat(t.slice(0,e));return n.concat(n,n)},y=function(){let e=r.daysInMonth(),t=r.date(),n=Array.from({length:e-t+1},(e,n)=>n+t).concat(Array.from({length:t-1},(e,t)=>t+1));return n.concat(n,n)},$=function(){let e=r.year();return Array.from({length:30},(t,n)=>n+e-10)},_=function(){let e=n.amPM?12:24,t=r.hour()%e;t=0==t?e:t;var a=Array.from({length:e-t+1},(e,n)=>n+t).concat(Array.from({length:t-1},(e,t)=>t+1));return a.concat(a,a)},T=function(){let e,t=Math.round(r.minute()/15);var n=Array.from({length:Math.round(4)-t},(e,n)=>(n+t)*15).concat(Array.from({length:t},(e,t)=>15*t));return n.concat(n,n)},g=function(e){if(e>0)for(let t=e-1;t>=0;t--)m.find("div:first").detach(),m.append('<div class="drum-item">'+v(i.length-1-t)+"</div>");else if(e<0)for(let n=-1*e-1;n>=0;n--)m.find("div:last").detach(),m.prepend('<div class="drum-item">'+v(n)+"</div>")},v=function(e){return i[0==e]?"00":i[e]},C=function(){l.empty(),u.empty(),m.empty(),l.append(u),u.append(m);for(let e=0;e<i.length;e++)m.append('<div class="drum-item">'+v(e)+"</div>");t.append(l)};this.setEvent=function(){var e=0,t=(i.length-1)*n.itemHeight;this.hummer=new Hammer(m[0],{recognizers:[[Hammer.Pan]]}),this.hummer.on("panstart",function(){e=A(),m.css("transition",""),o=0}),this.hummer.on("panmove",function(a){let i=-1*w();if(i!=d){let s=i-d;n.isLoop?(f(s),g(s),e+=s*n.itemHeight,o+=s):d+=s}let r=e+a.deltaY;n.isLoop||(r=r>=0?0:r<=-1*t?-1*t:r),x(),P(r)}),this.hummer.on("panend",function(){m.css("transition","margin-top 1s cubic-bezier(0.2, 1, 0.2, 1) 0s"),M(d),D()})};let D=function(){let e=s.getData();n.onDataChange&&n.onDataChange(e,r)};var M=function(e){P(-(e*n.itemHeight*1))},w=function(){return Math.round(A()/n.itemHeight)},A=function(){return parseInt(m.css("margin-top"))},P=function(e){m.css("margin-top",e+"px")},x=function(){t.find(".drum-item").removeClass("active"),t.find(".drum-item").eq(d).addClass("active")},b=function(){c(),C(),d="ampm"!=n.dataType?Math.round(i.length/3):"PM"==r.format("A")?1:0,x(),M(d)};this.refreshData=function(e){r=e,b()},this.getData=function(){return i[d]},b(),s.setEvent()};return this.setTime=function(e){a.setTime=moment(e),_(),g(),v()},this.init()}}(jQuery);